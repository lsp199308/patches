This guide will cover how to make a specific es patche, with System Firmware Version 13.0.0 targeted. It also assumes you have sorted your firmware files as described in part 2.

**this guide hasn't been formatted nicely yet, feel free to do it if you're interested, otherwise i'll do it sometime in the future**


the titleid for es is 0100000000000033
hactool firmware_files\1300\0100000000000033\7c10ca7db7fb2589323d8593f59f71b2.nca --exefsdir exefs
hactool -t nso0 exefs/main --uncompressed=uncompressed_main (take note of buildid, which is D0ECC9483E636AE19FE3E314DB41CB18019977D7000000000000000000000000 in the example of 13.0.0)

import uncompressed nso into ghidra.

![alt text](https://github.com/borntohonk/patches/blob/master/img/ghidra-es-offset-before.png?raw=true)
press s, search for type binary "111..... ......11 00...... 10010001 ........ ........ ........ 100101.. ........ ........ 00...... 10010001 ........ ........ ........ 100101.. ........ ........ 00...... 11010001 ........ ........ ........ 100101.." The line under the third BL arm instruction is what you're patching. The patch being applied is "MOV X0, XZR" (E0 03 1F AA) the offset is 03 15 28.

![alt text](https://github.com/borntohonk/patches/blob/master/img/ghidra-es-offset-after.png?raw=true)
save "50 41 54 43 48 03 15 28 00 04 E0 03 1F AA 45 4F 46" as D0ECC9483E636AE19FE3E314DB41CB18019977D7.ips



congrats you now have made a signature patch for ES 13.0.0